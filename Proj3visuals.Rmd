---
title: "Data 607 Project 3 Visuals"
author: "Curwen Arthurs"
date: "March 26, 2017"
output: html_document
---

## Loading packages to use

```{r}
library(RMySQL) # to connect to the database and get querry 
library(ggplot2) # to create visuals
```

## Connecting to the Mysql DataSkillset database (Not show here for security purposes)

```{r, include=FALSE}

con <- dbConnect(RMySQL::MySQL(), dbname = "DataSkills", user = "admin", password = "CUNYsps2017", host = "cuny-607-project-db.ce9yg7qxcc7l.us-east-2.rds.amazonaws.com", port = 3306)

```

## Analysis

For the analysis looking for the best ways to represent the correlation data after doing some research on various ggplots the following plot was used as it seemed to give the best picture of the data.

The forest plots make is easier to see exactly what the data is showing. On the y axis is the job-skill pair for data scientist job titles and on the x axis is the correlation scores.  

## 1. 
## Create subset data frame for data scentist jobs with hard skills

```{r}
# Using mysql
# 1. a new table was created for the min and max scores of each skill and called "scores". Code is below.

#Create table Scores
#select skill, min(score) AS Min, max(score) AS Max from `Correlation Scores` group by skill;

#Create table `Correlation Scores 2` 
#select ID, job, `Correlation Scores`.skill, score, Min, Max from `Correlation Scores`
#Left join Scores
#On `Correlation Scores`.skill = Scores.skill;


# 2. another table was created that joined the "scores"" table with the original "Correlation Scores"" table andd this table was named "Correlation Scores 2"



# Using the Rmysql dbGetQuery function a query(subset) of jobs with labels "data scientist" with selected hard skills was imported from the database into an R object.
# The job and skill columns were combined into 1 column "Job-Skill" and the score, min and max values where rounded to 2 decimal places for aesthics of the visual. 
data1<- as.data.frame(dbGetQuery(con, 
"
select ID, concat(job, ' ', '-', ' ', skill) AS `Job-Skill`, round(score,2) AS 'score', round(Min,2) AS 'Min', round(Max,2) AS 'Max' 
from `Correlation Scores 2` 
where job like 'data scientist' and 
skill in('sql', 'hadoop', 'python', 'java', 'r', 'hive', 'mapreduce', 'nosql', 'pig', 'sas', 'c', 'oracle', 'teradata', 'spss', 'matlab', 'perl', 'mysql', 'postgresql', 'ruby', 'html', 'stata', 
'agile','spark', 'java','apache', 'yarn', 'scala', 'mongodb', 'cassandra', 'hbase', 'c++', 'c#', 'data mining', 'statistics', 'modeling','computer science', 'mathematics', 'software development')

"))

```


## Create forest plot for data1

```{r}
# reverses the factor level ordering for labels after coord_flip()
data1$`Job-Skill` <- factor(data1$`Job-Skill`, levels=rev(data1$`Job-Skill`))

fp1 <- ggplot(data=data1, aes(x=`Job-Skill`, y=score, ymin=Min, ymax=Max)) +
        geom_pointrange(fill='green', color='green', shape=21, lwd=1, size=2) +
        geom_text(aes(label=score), hjust=0.5, vjust=2, size=3) + #adds label 
        geom_hline(yintercept=0, lty=2) +  # add a dotted line at x=1 after flip
        coord_flip() +  # flip coordinates (puts labels on y axis)
        xlab("Correlation") + ylab("Score") +
        theme_grey()  # use a white background
print(fp1)
```


From the plot above we see that Mathematics and Statistics have the highest correlation scores. Meanwhile for the software oracle has the highest correlation and surprisingly r has a negative correlation.

## 2. 
## Create subset data frame for data scentist jobs with soft skills

```{r}
data2<- as.data.frame(dbGetQuery(con, 
"
select ID, concat(job, ' ', '-', ' ', skill) AS `Job-Skill`, round(score,2) AS 'score', round(Min,2) AS 'Min', round(Max,2) AS 'Max'
from `Correlation Scores 2` 
where job like 'data scientist' and 
skill in('experience', 'business', 'team', 'skills', 'analytical', 'problem solving', 'understanding', 'algorithms', 'performance', 'big data', 'communication skills', 'solving', 'people', 'distributed', 'group', 'ideas', 'interpersonal', 
'leadership')

"))

```


## Create forest plot for data2

```{r}
# reverses the factor level ordering for labels after coord_flip()
data1$`Job-Skill` <- factor(data1$`Job-Skill`, levels=rev(data1$`Job-Skill`))

fp2 <- ggplot(data=data2, aes(x=`Job-Skill`, y=score, ymin=Min, ymax=Max)) +
        geom_pointrange(fill='green', color='green', shape=21, lwd=1, size=2) +
        geom_text(aes(label=score), hjust=0.5, vjust=2, size=3) +
        geom_hline(yintercept=0, lty=2) +  # add a dotted line at x=1 after flip
        coord_flip() +  # flip coordinates (puts labels on y axis)
        xlab("Correlation") + ylab("Score") +
        theme_grey()  # use a white background
print(fp2)
```

The plot above shows that soft skills are just as important as hard skills. We see that ideas(creativity) skills has the highest correlation with team skills and experience also having high correlations. 